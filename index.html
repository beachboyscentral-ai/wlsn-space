<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>WLSN | Western Light and Sound Network</title>
<style>
:root{
  --bg:#0b0e0b;
  --green:#2ad01f;
  --green-d:#104a0c;
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--green);font-family:Courier New, monospace}
a{color:var(--green);text-decoration:none}
header{border-bottom:1px solid var(--green);padding:24px}
.brand{font-size:36px;letter-spacing:6px}
.sub{font-size:11px;color:#3d8b3a;margin-top:4px}
nav{margin-top:16px}
nav a{
  display:inline-block;
  border:1px solid var(--green);
  padding:10px 18px;
  margin-right:8px;
}
nav a.active{
  box-shadow:0 0 10px rgba(42,208,31,.7);
}
main{padding:24px;max-width:1200px;margin:0 auto}
.panel{
  border:1px solid var(--green);
  padding:16px;
  margin-bottom:24px;
}
h2{margin:0 0 12px 0;font-size:14px;letter-spacing:2px}
.audio-bar{
  display:flex;
  align-items:center;
  gap:12px;
}
audio{width:100%}
.table-wrap{overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:12px}
th,td{border:1px solid var(--green);padding:8px;text-align:left}
th{color:#9bff8e}
.type-tag{border:1px solid var(--green);padding:2px 6px;font-size:10px}
.footer{border-top:1px solid var(--green);padding:16px;text-align:center;font-size:10px;color:#3d8b3a}
.hidden{display:none}


/* --- PATCH: Stronger nav glow + pulse --- */
nav a{
  position:relative;
  transition: box-shadow .12s, background .12s, color .12s, opacity .12s;
}
nav a:hover{
  background: rgba(40,212,40,0.14);
  color: var(--crt-green);
  box-shadow:
    0 0 10px rgba(0,255,102,0.25),
    0 0 26px rgba(0,255,102,0.22),
    inset 0 0 10px rgba(0,255,102,0.10);
}
nav a.active{
  background: rgba(40,212,40,0.30);
  color: var(--crt-green);
  box-shadow:
    0 0 14px rgba(0,255,102,0.34),
    0 0 34px rgba(0,255,102,0.28),
    inset 0 0 14px rgba(0,255,102,0.14);
  animation: navPulse 1.45s ease-in-out infinite;
}
@keyframes navPulse{
  0%,100%{
    box-shadow:
      0 0 12px rgba(0,255,102,0.28),
      0 0 28px rgba(0,255,102,0.22),
      inset 0 0 12px rgba(0,255,102,0.10);
  }
  50%{
    box-shadow:
      0 0 18px rgba(0,255,102,0.40),
      0 0 44px rgba(0,255,102,0.30),
      inset 0 0 16px rgba(0,255,102,0.16);
  }
}

/* --- PATCH: Consistent table spacing + hierarchy + no wrap in TYPE/YEAR --- */
.table-wrap{overflow-x:auto;}
table{width:100%; border-collapse:collapse;}
th, td{padding:12px 14px; border-bottom:1px solid rgba(40,212,40,0.16); vertical-align:top;}
th{font-size:10px; letter-spacing:2px; text-transform:uppercase; opacity:0.85;}
td{font-size:12px; opacity:0.88; line-height:1.45;}
td:nth-child(2), th:nth-child(2),
td:nth-child(5), th:nth-child(5){
  white-space:nowrap;
}
td:nth-child(2), th:nth-child(2){width:120px;}
td:nth-child(5), th:nth-child(5){width:90px;}
td:nth-child(3){font-weight:700; color:var(--crt-green); letter-spacing:0.3px;}
td:nth-child(4), td:nth-child(5){color:var(--crt-dim); opacity:0.92;}
tr:hover td{background:rgba(40,212,40,0.04);}

.type-tag{
  display:inline-block;
  padding:3px 8px;
  border:1px solid var(--crt-dim);
  background:rgba(0,0,0,0.22);
  letter-spacing:2px;
  font-size:9px;
  font-weight:700;
  text-transform:uppercase;
  white-space:nowrap;
}

/* --- PATCH: Medium confidence orange (if used later) --- */
.conf-medium{color:#ff9a33; font-weight:700}

/* --- PATCH: Custom audio controls --- */
.audio-bar{padding:14px; border:1px solid rgba(40,212,40,0.20); background:rgba(0,0,0,0.18);}
.audio-ui{display:flex; gap:12px; align-items:center; flex-wrap:wrap;}
.audio-ui .btn-mini{
  width:40px; height:40px;
  border:2px solid var(--crt-green);
  background:transparent;
  color:var(--crt-green);
  font-family:var(--mono);
  font-size:16px;
  cursor:pointer;
}
.audio-ui .btn-mini:hover{background:var(--crt-green); color:var(--crt-bg);}
.audio-ui .time{font-size:10px; letter-spacing:2px; color:var(--crt-dim); min-width:120px;}
.audio-ui input[type="range"]{
  flex:1;
  min-width:200px;
  accent-color: var(--crt-green);
}
</style>
</head>
<body>
<header>
  <div class="brand">WLSN█</div>
  <div class="sub">WESTERN LIGHT AND SOUND NETWORK<br>SIGNAL ARCHIVE</div>
  <nav>
    <a href="#/archive" id="nav-archive">BROADCAST ARCHIVE</a>
    <a href="#/info" id="nav-info">INFO</a>
  </nav>
</header>

<main id="app"></main>

<div class="footer">
WLSN ARCHIVE SYSTEM | EST. 1967 | DECLASSIFIED 2025<br>
Produced by Brain Crampsmen for WLSN under the ONE Signal distribution mark.
</div>

<script>
const app = document.getElementById('app');
const navArchive = document.getElementById('nav-archive');
const navInfo = document.getElementById('nav-info');

function setActive(hash){
  navArchive.classList.toggle('active', hash.startsWith('#/archive') || hash.startsWith('#/transmissions'));
  navInfo.classList.toggle('active', hash.startsWith('#/info'));
}


function bindAudioUI(root){
  const ui = root.querySelector('[data-audio-ui]');
  if(!ui) return;
  const audio = ui.querySelector('audio');
  const play = ui.querySelector('[data-audio-play]');
  const time = ui.querySelector('[data-audio-time]');
  const scrub = ui.querySelector('[data-audio-scrub]');
  if(!audio || !play || !time || !scrub) return;

  audio.preload = 'auto';

  const pad2 = (n) => String(n).padStart(2,'0');
  const fmt = (t) => {
    if(!isFinite(t)) return '00:00';
    const m = Math.floor(t / 60);
    const s = Math.floor(t % 60);
    return `${pad2(m)}:${pad2(s)}`;
  };

  let isScrubbing = false;

  const sync = () => {
    const cur = audio.currentTime || 0;
    const dur = audio.duration || 0;
    time.textContent = `${fmt(cur)} / ${fmt(dur)}`;
    if(!isScrubbing && dur > 0){
      scrub.value = String(Math.round((cur / dur) * 1000));
    }
  };

  play.addEventListener('click', () => {
    if(audio.paused){
      audio.play().then(() => { play.textContent = '❚❚'; }).catch(()=>{});
    }else{
      audio.pause();
      play.textContent = '▶';
    }
  });

  audio.addEventListener('timeupdate', sync);
  audio.addEventListener('loadedmetadata', sync);
  audio.addEventListener('ended', () => { play.textContent = '▶'; });

  // Smooth scrubbing: update on input while dragging
  const seekFromScrub = () => {
    const dur = audio.duration || 0;
    if(dur <= 0) return;
    const p = Number(scrub.value) / 1000;
    audio.currentTime = Math.max(0, Math.min(dur, p * dur));
    sync();
  };

  scrub.addEventListener('pointerdown', () => { isScrubbing = true; });
  scrub.addEventListener('pointerup', () => { isScrubbing = false; });
  scrub.addEventListener('input', seekFromScrub);

  // Click-to-seek (range handles this, but keep for safety)
  scrub.addEventListener('change', () => { isScrubbing = false; seekFromScrub(); });

  // Initialize
  sync();
}


function normalizeYears(root){
  root.querySelectorAll('tbody tr td:nth-child(5)').forEach(td => {
    const t = (td.textContent || '').trim();
    if(!t) td.textContent = '1960s';
  });
}

function renderArchive(){
  app.innerHTML = `
  <div class="panel">
    <h2>LATEST TRANSMISSION</h2>
    <a href="#/transmissions/002">Transmission 002</a>
  </div>
  <div class="panel">
    <h2>TRANSMISSIONS</h2>
    <a href="#/transmissions/002">002</a>
  </div>`;
}

function renderInfo(){
  app.innerHTML = `
  <div class="panel">
    <h2>INFO</h2>
    <p>Recovered discussion, archive images, and update channels for newly linked transmissions.</p>
  </div>`;
}

function renderTransmission002(){
  app.innerHTML = `
  <div class="panel">
    <h2>TRANSMISSION 002</h2>
    <div class="audio-bar" data-audio-ui>
      <audio preload="auto" src="audio/transmission_002.mp3"></audio>
      <div class="audio-ui">
        <button class="btn-mini" type="button" data-audio-play>▶</button>
        <div class="time" data-audio-time>00:00 / 00:00</div>
        <input type="range" min="0" max="1000" value="0" step="1" data-audio-scrub aria-label="Scrub" />
      </div>
    </div>
  </div>

  <div class="panel">
    <h2>ARTIFACTS</h2>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>TIME</th>
            <th>TYPE</th>
            <th>TITLE</th>
            <th>ARTIST / SOURCE</th>
            <th>YEAR</th>
          </tr>
        </thead>
        <tbody>
          <tr><td></td><td><span class="type-tag">SFX</span></td><td>Rays</td><td>Radio FX Library</td><td>1960s</td></tr>
          <tr><td></td><td><span class="type-tag">MUSIC</span></td><td>It Came from Outer Space</td><td>Herman Stein</td><td>1953</td></tr>
          <tr><td></td><td><span class="type-tag">JINGLE</span></td><td>WHBQ Ident</td><td>WHBQ Memphis</td><td>1960s</td></tr>
          <tr><td></td><td><span class="type-tag">NARRATION</span></td><td>Robinson Crusoe on Mars</td><td>Adam West</td><td>1964</td></tr>
          <tr><td></td><td><span class="type-tag">COMMERCIAL</span></td><td>Pillsbury Cookies</td><td>Benton & Bowles</td><td>1960s</td></tr>
          <tr><td></td><td><span class="type-tag">COMMERCIAL</span></td><td>Camel Cigarettes</td><td>R.J. Reynolds</td><td>1960s</td></tr>
          <tr><td></td><td><span class="type-tag">SONG</span></td><td>It's You</td><td>The Millennium</td><td>1968</td></tr>
          <tr><td></td><td><span class="type-tag">SONG</span></td><td>2002 - A Hit Song</td><td>The Free Design</td><td>1967</td></tr>
          <tr><td></td><td><span class="type-tag">SONG</span></td><td>It's My Party</td><td>Lesley Gore</td><td>1963</td></tr>
          <tr><td></td><td><span class="type-tag">SONG</span></td><td>God Only Knows</td><td>The Beach Boys</td><td>1966</td></tr>
          <tr><td></td><td><span class="type-tag">SONG</span></td><td>In My Lonely Room</td><td>Martha Reeves & The Vandellas</td><td>1964</td></tr>
        </tbody>
      </table>
    </div>
  </div>`;
  bindAudioUI(app);
  normalizeYears(app);
}

function router(){
  const hash = location.hash || '#/archive';
  setActive(hash);
  if(hash === '#/archive') renderArchive();
  else if(hash === '#/info') renderInfo();
  else if(hash === '#/transmissions/002') renderTransmission002();
  else renderArchive();
}

window.addEventListener('hashchange', router);
router();
</script>
</body>
</html>
